{
  "sha": "d817eb1015ca1978387287811e6dce7e51b91635",
  "node_id": "C_kwDOP2Zrm9oAKGQ4MTdlYjEwMTVjYTE5NzgzODcyODc4MTFlNmRjZTdlNTFiOTE2MzU",
  "commit": {
    "author": {
      "name": "lexicalmathical",
      "email": "lexicalmathical@gmail.com",
      "date": "2025-11-02T06:52:33Z"
    },
    "committer": {
      "name": "lexicalmathical",
      "email": "lexicalmathical@gmail.com",
      "date": "2025-11-02T06:52:33Z"
    },
    "message": "Remove unused legacy files\n\nDeleted 4 legacy files that are no longer imported anywhere:\n- WritingArea.tsx (replaced by multi-cell system in App.tsx)\n- EditableTextArea.tsx (replaced by per-cell textareas)\n- VoiceQuote.tsx (replaced by inline comment system)\n- documentStorage.ts (migrated to database storage)\n\nBundle size unchanged (341.78 kB), confirming files were already tree-shaken.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>",
    "tree": {
      "sha": "ebceca349bdc8515650bbd84b5e04a6f228253e9",
      "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/git/trees/ebceca349bdc8515650bbd84b5e04a6f228253e9"
    },
    "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/git/commits/d817eb1015ca1978387287811e6dce7e51b91635",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null,
      "verified_at": null
    }
  },
  "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/d817eb1015ca1978387287811e6dce7e51b91635",
  "html_url": "https://github.com/shuxueshuxue/ink-and-memory/commit/d817eb1015ca1978387287811e6dce7e51b91635",
  "comments_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/d817eb1015ca1978387287811e6dce7e51b91635/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "6849d360219982aad2562f716a69a1fffe9dee28",
      "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/6849d360219982aad2562f716a69a1fffe9dee28",
      "html_url": "https://github.com/shuxueshuxue/ink-and-memory/commit/6849d360219982aad2562f716a69a1fffe9dee28"
    }
  ],
  "stats": {
    "total": 624,
    "additions": 0,
    "deletions": 624
  },
  "files": [
    {
      "sha": "c9dfdf9d30f575ba2e0249de1fdc9f0105f86543",
      "filename": "backend/data/ink-and-memory.db",
      "status": "modified",
      "additions": 0,
      "deletions": 0,
      "changes": 0,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/d817eb1015ca1978387287811e6dce7e51b91635/backend%2Fdata%2Fink-and-memory.db",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/d817eb1015ca1978387287811e6dce7e51b91635/backend%2Fdata%2Fink-and-memory.db",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/backend%2Fdata%2Fink-and-memory.db?ref=d817eb1015ca1978387287811e6dce7e51b91635"
    },
    {
      "sha": "2759f9549210aa7a23941a87143b152edf549997",
      "filename": "frontend/src/components/EditableTextArea.tsx",
      "status": "removed",
      "additions": 0,
      "deletions": 161,
      "changes": 161,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fcomponents%2FEditableTextArea.tsx",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fcomponents%2FEditableTextArea.tsx",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/frontend%2Fsrc%2Fcomponents%2FEditableTextArea.tsx?ref=6849d360219982aad2562f716a69a1fffe9dee28",
      "patch": "@@ -1,161 +0,0 @@\n-import { useEditor, EditorContent } from '@tiptap/react';\n-import { useEffect, forwardRef, useImperativeHandle } from 'react';\n-import StarterKit from '@tiptap/starter-kit';\n-import Placeholder from '@tiptap/extension-placeholder';\n-import { VoiceHighlight, type VoiceTrigger } from '../extensions/VoiceHighlight';\n-import VoiceQuote from '../extensions/VoiceQuote';\n-\n-interface EditableTextAreaProps {\n-  onChange: (text: string) => void;\n-  onContentChange?: (html: string) => void;\n-  triggers: VoiceTrigger[];\n-  onCursorChange?: (position: number) => void;\n-  onPhraseHover?: (phrase: string | null) => void;\n-  content?: string;\n-}\n-\n-export interface EditableTextAreaRef {\n-  insertText: (text: string) => void;\n-  insertVoiceQuote: (voiceName: string, comment: string, voiceConfig?: any) => void;\n-  getTextWithoutQuotes: () => string;\n-  getQuotedComments: () => Array<{ voiceName: string; comment: string }>;\n-  getJSON: () => any;\n-  setJSON: (json: any) => void;\n-}\n-\n-const EditableTextArea = forwardRef<EditableTextAreaRef, EditableTextAreaProps>(\n-  (props, ref) => {\n-    const { onChange, onContentChange, triggers, onCursorChange, onPhraseHover, content } = props;\n-\n-    const editor = useEditor({\n-      extensions: [\n-        StarterKit,\n-        Placeholder.configure({\n-          placeholder: 'write here, I am listening...',\n-        }),\n-        VoiceHighlight.configure({\n-          triggers,\n-          onPhraseHover\n-        }),\n-        VoiceQuote\n-      ],\n-      content: content || '',\n-      onUpdate: ({ editor }) => {\n-        onChange(editor.getText());\n-        onContentChange?.(editor.getHTML());\n-        onCursorChange?.(editor.state.selection.from);\n-      },\n-      onSelectionUpdate: ({ editor }) => {\n-        onCursorChange?.(editor.state.selection.from);\n-      },\n-      autofocus: true,\n-    });\n-\n-    // @@@ Expose editor to window for debugging\n-    useEffect(() => {\n-      if (editor) {\n-        (window as any).__editor = editor;\n-      }\n-    }, [editor]);\n-\n-    // @@@ Dynamic trigger updates - Update highlights when triggers change\n-    useEffect(() => {\n-      if (editor && editor.isEditable) {\n-        // Force recalculation by creating a new transaction with meta\n-        const tr = editor.state.tr;\n-        tr.setMeta('voiceHighlight', { triggers });\n-        editor.view.dispatch(tr);\n-      }\n-    }, [triggers, editor]);\n-\n-    // @@@ Update onPhraseHover callback when it changes\n-    useEffect(() => {\n-      if (editor) {\n-        editor.extensionManager.extensions.forEach((ext: any) => {\n-          if (ext.name === 'voiceHighlight' && ext.options) {\n-            ext.options.onPhraseHover = onPhraseHover;\n-          }\n-        });\n-      }\n-    }, [onPhraseHover, editor]);\n-\n-    // Expose methods to parent component\n-    useImperativeHandle(ref, () => ({\n-      insertText: (text: string) => {\n-        if (editor) {\n-          // Insert text at current cursor position\n-          editor.chain().focus().insertContent(text).run();\n-        }\n-      },\n-      insertVoiceQuote: (voiceName: string, comment: string, voiceConfig?: any) => {\n-        if (editor) {\n-          // @@@ Generate unique ID for this widget (for conversation tracking)\n-          const widgetId = `widget_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n-\n-          // Insert atomic voice quote widget\n-          editor.chain().focus().insertContent({\n-            type: 'voiceQuote',\n-            attrs: {\n-              widgetId,\n-              voiceName,\n-              comment,\n-              timestamp: Date.now(),\n-              voiceConfig: voiceConfig || {}\n-            }\n-          }).run();\n-        }\n-      },\n-      getTextWithoutQuotes: () => {\n-        if (!editor) return '';\n-\n-        // @@@ Extract text excluding voice quote nodes\n-        let textWithoutQuotes = '';\n-        editor.state.doc.descendants((node) => {\n-          // Skip voice quote nodes entirely\n-          if (node.type.name === 'voiceQuote') {\n-            return false;\n-          }\n-          // Collect text from other nodes\n-          if (node.isText) {\n-            textWithoutQuotes += node.text;\n-          }\n-          return true;\n-        });\n-\n-        return textWithoutQuotes;\n-      },\n-      getQuotedComments: () => {\n-        if (!editor) return [];\n-\n-        // @@@ Extract all quoted comments from voice quote widgets\n-        const quotedComments: Array<{ voiceName: string; comment: string }> = [];\n-        editor.state.doc.descendants((node) => {\n-          if (node.type.name === 'voiceQuote') {\n-            quotedComments.push({\n-              voiceName: node.attrs.voiceName,\n-              comment: node.attrs.comment\n-            });\n-          }\n-        });\n-\n-        return quotedComments;\n-      },\n-      getJSON: () => {\n-        if (!editor) return null;\n-        // @@@ JSON is the proper format for persistence (not HTML)\n-        return editor.getJSON();\n-      },\n-      setJSON: (json: any) => {\n-        if (!editor) return;\n-        // @@@ Restore from JSON (proper way, not HTML)\n-        editor.commands.setContent(json);\n-      }\n-    }), [editor]);\n-\n-    return <div className=\"editable-text-area\"><EditorContent editor={editor} /></div>;\n-  }\n-);\n-\n-EditableTextArea.displayName = 'EditableTextArea';\n-\n-export default EditableTextArea;"
    },
    {
      "sha": "3bfb79dce873474be6cdd67b107231226708f2b8",
      "filename": "frontend/src/components/WritingArea.tsx",
      "status": "removed",
      "additions": 0,
      "deletions": 25,
      "changes": 25,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fcomponents%2FWritingArea.tsx",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fcomponents%2FWritingArea.tsx",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/frontend%2Fsrc%2Fcomponents%2FWritingArea.tsx?ref=6849d360219982aad2562f716a69a1fffe9dee28",
      "patch": "@@ -1,25 +0,0 @@\n-import { forwardRef } from 'react';\n-import BookPage from './BookPage';\n-import EditableTextArea, { type EditableTextAreaRef } from './EditableTextArea';\n-import type { VoiceTrigger } from '../extensions/VoiceHighlight';\n-\n-interface WritingAreaProps {\n-  onChange: (text: string) => void;\n-  onContentChange?: (html: string) => void;\n-  triggers: VoiceTrigger[];\n-  onCursorChange?: (position: number) => void;\n-  onPhraseHover?: (phrase: string | null) => void;\n-  content?: string;\n-}\n-\n-const WritingArea = forwardRef<EditableTextAreaRef, WritingAreaProps>(({ onChange, onContentChange, triggers, onCursorChange, onPhraseHover, content }, ref) => {\n-  return (\n-    <BookPage side=\"left\">\n-      <EditableTextArea ref={ref} onChange={onChange} onContentChange={onContentChange} triggers={triggers} onCursorChange={onCursorChange} onPhraseHover={onPhraseHover} content={content} />\n-    </BookPage>\n-  );\n-});\n-\n-WritingArea.displayName = 'WritingArea';\n-\n-export default WritingArea;\n\\ No newline at end of file"
    },
    {
      "sha": "a4253b1f917d42dd8a7b837bd4e343b3939f4f79",
      "filename": "frontend/src/extensions/VoiceQuote.tsx",
      "status": "removed",
      "additions": 0,
      "deletions": 363,
      "changes": 363,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fextensions%2FVoiceQuote.tsx",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Fextensions%2FVoiceQuote.tsx",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/frontend%2Fsrc%2Fextensions%2FVoiceQuote.tsx?ref=6849d360219982aad2562f716a69a1fffe9dee28",
      "patch": "@@ -1,363 +0,0 @@\n-import { Node, mergeAttributes } from '@tiptap/core';\n-import { ReactNodeViewRenderer, NodeViewWrapper } from '@tiptap/react';\n-import { Node as ProseMirrorNode } from '@tiptap/pm/model';\n-import { useState, useEffect } from 'react';\n-import { DocumentStorage } from '../utils/documentStorage';\n-\n-interface Message {\n-  role: 'user' | 'assistant';\n-  content: string;\n-  timestamp: number;\n-}\n-\n-// @@@ Singleton storage instance\n-const storage = new DocumentStorage();\n-\n-// @@@ React component for rendering the quote widget with chat\n-function VoiceQuoteView({ node, deleteNode, editor }: { node: ProseMirrorNode; deleteNode: () => void; editor: any }) {\n-  const { voiceName, comment, timestamp, widgetId } = node.attrs;\n-  const [isHovered, setIsHovered] = useState(false);\n-  const [inputText, setInputText] = useState('');\n-  const [isLoading, setIsLoading] = useState(false);\n-\n-  // @@@ Load conversation from storage, or initialize with first message\n-  const [messages, setMessages] = useState<Message[]>(() => {\n-    const saved = storage.getConversation(widgetId);\n-    return saved.length > 0 ? saved : [{ role: 'assistant', content: comment, timestamp }];\n-  });\n-\n-  // @@@ Save conversation whenever messages change\n-  useEffect(() => {\n-    if (messages.length > 0) {\n-      storage.updateConversation(widgetId, messages);\n-    }\n-  }, [messages, widgetId]);\n-\n-  const handleSendMessage = async () => {\n-    if (!inputText.trim() || isLoading) return;\n-\n-    const userMessage: Message = {\n-      role: 'user',\n-      content: inputText,\n-      timestamp: Date.now()\n-    };\n-\n-    setMessages(prev => [...prev, userMessage]);\n-    setInputText('');\n-    setIsLoading(true);\n-\n-    try {\n-      // @@@ Call backend chat API with full conversation history\n-      const { chatWithVoice } = await import('../api/voiceApi');\n-\n-      // @@@ Get voice config from node attrs (stored when widget created)\n-      // Ensure it's an object (not string due to serialization)\n-      let voiceConfig = node.attrs.voiceConfig;\n-      if (typeof voiceConfig === 'string') {\n-        try {\n-          voiceConfig = JSON.parse(voiceConfig);\n-        } catch (e) {\n-          voiceConfig = { tagline: `${voiceName} voice from Disco Elysium` };\n-        }\n-      } else if (!voiceConfig || typeof voiceConfig !== 'object') {\n-        voiceConfig = { tagline: `${voiceName} voice from Disco Elysium` };\n-      }\n-\n-      // @@@ Extract writing area text (exclude voice quote widgets)\n-      let writingAreaText = '';\n-      if (editor) {\n-        editor.state.doc.descendants((node: any) => {\n-          // Skip voice quote nodes\n-          if (node.type.name === 'voiceQuote') {\n-            return false;\n-          }\n-          // Collect text from other nodes\n-          if (node.isText) {\n-            writingAreaText += node.text;\n-          }\n-          return true;\n-        });\n-      }\n-\n-      // Send entire conversation history + writing area text for context\n-      const response = await chatWithVoice(\n-        voiceName,\n-        voiceConfig,\n-        messages,\n-        inputText,\n-        writingAreaText\n-      );\n-\n-      const assistantMessage: Message = {\n-        role: 'assistant',\n-        content: response,\n-        timestamp: Date.now()\n-      };\n-      setMessages(prev => [...prev, assistantMessage]);\n-    } catch (error) {\n-      console.error('Chat error:', error);\n-      const errorMessage: Message = {\n-        role: 'assistant',\n-        content: `Sorry, I couldn't respond. (${error})`,\n-        timestamp: Date.now()\n-      };\n-      setMessages(prev => [...prev, errorMessage]);\n-    } finally {\n-      setIsLoading(false);\n-    }\n-  };\n-\n-  const handleKeyDown = (e: React.KeyboardEvent) => {\n-    if (e.key === 'Enter' && !e.shiftKey) {\n-      e.preventDefault();\n-      handleSendMessage();\n-    }\n-  };\n-\n-  return (\n-    <NodeViewWrapper className=\"voice-quote-widget\">\n-      <div\n-        contentEditable={false}\n-        onMouseEnter={() => setIsHovered(true)}\n-        onMouseLeave={() => setIsHovered(false)}\n-        style={{\n-          background: 'linear-gradient(135deg, rgba(255, 248, 240, 0.95), rgba(255, 250, 245, 0.95))',\n-          border: '1px solid #d0c4b0',\n-          borderRadius: 12,\n-          padding: '16px 20px',\n-          margin: '16px 0',\n-          fontFamily: 'Georgia, \"Times New Roman\", serif',\n-          fontSize: 16,\n-          lineHeight: 1.8,\n-          position: 'relative',\n-          cursor: 'default',\n-          userSelect: 'none',\n-          boxShadow: '0 2px 8px rgba(0, 0, 0, 0.05)',\n-          transition: 'all 0.2s'\n-        }}\n-      >\n-        {/* Delete button - only visible on hover */}\n-        {isHovered && (\n-          <button\n-            onClick={deleteNode}\n-            style={{\n-              position: 'absolute',\n-              top: 12,\n-              right: 12,\n-              width: 24,\n-              height: 24,\n-              borderRadius: 12,\n-              border: '1px solid #d0c4b0',\n-              background: '#fff',\n-              cursor: 'pointer',\n-              display: 'flex',\n-              alignItems: 'center',\n-              justifyContent: 'center',\n-              fontSize: 16,\n-              color: '#666',\n-              padding: 0,\n-              transition: 'all 0.2s',\n-              boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',\n-              zIndex: 10\n-            }}\n-            onMouseEnter={e => {\n-              e.currentTarget.style.background = '#f0e6d8';\n-              e.currentTarget.style.color = '#c33';\n-              e.currentTarget.style.borderColor = '#c33';\n-            }}\n-            onMouseLeave={e => {\n-              e.currentTarget.style.background = '#fff';\n-              e.currentTarget.style.color = '#666';\n-              e.currentTarget.style.borderColor = '#d0c4b0';\n-            }}\n-            title=\"Delete quote\"\n-          >\n-            Ã—\n-          </button>\n-        )}\n-\n-        <div\n-          style={{\n-            fontWeight: 600,\n-            color: '#2c2c2c',\n-            marginBottom: 8,\n-            fontSize: 15,\n-            paddingRight: isHovered ? 32 : 0,\n-            transition: 'padding-right 0.2s',\n-            letterSpacing: '0.3px'\n-          }}\n-        >\n-          {voiceName}\n-        </div>\n-\n-        {/* Initial comment (always visible) */}\n-        <div\n-          style={{\n-            color: '#444',\n-            fontStyle: 'italic',\n-            fontSize: 16\n-          }}\n-        >\n-          \"{comment}\"\n-        </div>\n-\n-        {timestamp && (\n-          <div\n-            style={{\n-              fontSize: 12,\n-              color: '#999',\n-              marginTop: 8,\n-              fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif'\n-            }}\n-          >\n-            {new Date(timestamp).toLocaleTimeString()}\n-          </div>\n-        )}\n-\n-        {/* Chat messages - appear naturally after initial comment */}\n-        {messages.slice(1).map((msg, idx) => (\n-          <div\n-            key={idx}\n-            style={{\n-              marginTop: 16,\n-              color: msg.role === 'user' ? '#555' : '#444',\n-              fontSize: 15,\n-              fontFamily: msg.role === 'user'\n-                ? '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif'\n-                : 'Georgia, \"Times New Roman\", serif',\n-              fontStyle: msg.role === 'assistant' ? 'italic' : 'normal',\n-              paddingLeft: msg.role === 'user' ? 20 : 0,\n-              borderLeft: msg.role === 'user' ? '2px solid #d0c4b0' : 'none'\n-            }}\n-          >\n-            {msg.role === 'user' && <span style={{ fontWeight: 500, color: '#888' }}>You: </span>}\n-            {msg.content}\n-          </div>\n-        ))}\n-\n-        {isLoading && (\n-          <div\n-            style={{\n-              marginTop: 16,\n-              color: '#999',\n-              fontSize: 15,\n-              fontFamily: 'Georgia, \"Times New Roman\", serif',\n-              fontStyle: 'italic'\n-            }}\n-          >\n-            Thinking...\n-          </div>\n-        )}\n-\n-        {/* Input area */}\n-        <div style={{ display: 'flex', gap: 8, marginTop: 16 }}>\n-            <input\n-              type=\"text\"\n-              value={inputText}\n-              onChange={(e) => setInputText(e.target.value)}\n-              onKeyDown={handleKeyDown}\n-              placeholder=\"Reply...\"\n-              disabled={isLoading}\n-              style={{\n-                flex: 1,\n-                padding: '8px 12px',\n-                fontSize: 14,\n-                fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n-                background: 'transparent',\n-                border: 'none',\n-                borderBottom: '1px solid #d0c4b0',\n-                borderRadius: 0,\n-                outline: 'none',\n-                color: '#2c2c2c'\n-              }}\n-            />\n-            <button\n-              onClick={handleSendMessage}\n-              disabled={!inputText.trim() || isLoading}\n-              style={{\n-                padding: '6px 14px',\n-                fontSize: 13,\n-                fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n-                background: 'transparent',\n-                border: 'none',\n-                borderRadius: 0,\n-                cursor: inputText.trim() && !isLoading ? 'pointer' : 'not-allowed',\n-                color: inputText.trim() && !isLoading ? '#4CAF50' : '#ccc',\n-                fontWeight: 500,\n-                transition: 'all 0.2s'\n-              }}\n-              onMouseEnter={e => {\n-                if (inputText.trim() && !isLoading) {\n-                  e.currentTarget.style.color = '#45a049';\n-                }\n-              }}\n-              onMouseLeave={e => {\n-                if (inputText.trim() && !isLoading) {\n-                  e.currentTarget.style.color = '#4CAF50';\n-                }\n-              }}\n-            >\n-              â†’\n-            </button>\n-        </div>\n-      </div>\n-    </NodeViewWrapper>\n-  );\n-}\n-\n-// @@@ Custom TipTap node for voice quotes - atomic and uneditable\n-export const VoiceQuote = Node.create({\n-  name: 'voiceQuote',\n-\n-  group: 'block',\n-\n-  atom: true, // Makes it atomic - can't edit inside, only delete whole thing\n-\n-  selectable: false, // Cannot be selected, prevents replacement when typing\n-\n-  draggable: false, // Disable drag to prevent accidental moves\n-\n-  addAttributes() {\n-    return {\n-      widgetId: {\n-        default: '',\n-      },\n-      voiceName: {\n-        default: '',\n-      },\n-      comment: {\n-        default: '',\n-      },\n-      timestamp: {\n-        default: null,\n-      },\n-      voiceConfig: {\n-        default: {},\n-      },\n-    };\n-  },\n-\n-  parseHTML() {\n-    return [\n-      {\n-        tag: 'div[data-type=\"voice-quote\"]',\n-      },\n-    ];\n-  },\n-\n-  renderHTML({ node, HTMLAttributes }) {\n-    // Render as a self-contained div with data attributes\n-    return ['div', mergeAttributes(HTMLAttributes, {\n-      'data-type': 'voice-quote',\n-      'data-voice-name': node.attrs.voiceName,\n-      'data-comment': node.attrs.comment,\n-      'data-timestamp': node.attrs.timestamp\n-    })];\n-  },\n-\n-  addNodeView() {\n-    return ReactNodeViewRenderer(VoiceQuoteView);\n-  },\n-});\n-\n-export default VoiceQuote;"
    },
    {
      "sha": "fd4094b12b1bb65a94730489e3277362e228647e",
      "filename": "frontend/src/utils/documentStorage.ts",
      "status": "removed",
      "additions": 0,
      "deletions": 75,
      "changes": 75,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Futils%2FdocumentStorage.ts",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/6849d360219982aad2562f716a69a1fffe9dee28/frontend%2Fsrc%2Futils%2FdocumentStorage.ts",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/frontend%2Fsrc%2Futils%2FdocumentStorage.ts?ref=6849d360219982aad2562f716a69a1fffe9dee28",
      "patch": "@@ -1,75 +0,0 @@\n-// @@@ Document storage wrapper - manages both TipTap content and chat conversations\n-\n-interface Message {\n-  role: 'user' | 'assistant';\n-  content: string;\n-  timestamp: number;\n-}\n-\n-interface StoredDocument {\n-  document: any; // TipTap JSON\n-  conversations: Record<string, Message[]>; // widgetId -> messages\n-  lastModified: number;\n-}\n-\n-export class DocumentStorage {\n-  private storageKey: string;\n-\n-  constructor(storageKey: string = 'ink_and_memory_document') {\n-    this.storageKey = storageKey;\n-  }\n-\n-  // @@@ Save document + conversations\n-  save(documentJSON: any, conversations: Record<string, Message[]>): void {\n-    const stored: StoredDocument = {\n-      document: documentJSON,\n-      conversations,\n-      lastModified: Date.now()\n-    };\n-    localStorage.setItem(this.storageKey, JSON.stringify(stored));\n-  }\n-\n-  // @@@ Load document + conversations\n-  load(): StoredDocument | null {\n-    const stored = localStorage.getItem(this.storageKey);\n-    if (!stored) return null;\n-\n-    try {\n-      return JSON.parse(stored);\n-    } catch (e) {\n-      console.error('Failed to parse stored document:', e);\n-      return null;\n-    }\n-  }\n-\n-  // @@@ Get conversation for a specific widget\n-  getConversation(widgetId: string): Message[] {\n-    const stored = this.load();\n-    return stored?.conversations[widgetId] || [];\n-  }\n-\n-  // @@@ Update conversation for a specific widget\n-  updateConversation(widgetId: string, messages: Message[]): void {\n-    let stored = this.load();\n-\n-    // @@@ Initialize if not exists\n-    if (!stored) {\n-      stored = {\n-        document: null,\n-        conversations: {},\n-        lastModified: Date.now()\n-      };\n-    }\n-\n-    stored.conversations[widgetId] = messages;\n-    stored.lastModified = Date.now();\n-    localStorage.setItem(this.storageKey, JSON.stringify(stored));\n-  }\n-\n-  // @@@ Clear all data\n-  clear(): void {\n-    localStorage.removeItem(this.storageKey);\n-  }\n-}\n-\n-export default DocumentStorage;"
    }
  ]
}